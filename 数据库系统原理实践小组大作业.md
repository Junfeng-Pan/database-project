根据您上传的两个文档，我将其主要内容转换为 Markdown 格式。这两份文档分别是一份**数据库课程设计任务书**和一份**openGauss 数据库安装部署指南**。

以下是去除了附录等非核心内容后的精简版摘要：

---

# 文档一：数据库系统原理实践小组大作业

## 1. 项目背景与目标

**项目名称**：校园一卡通消费系统数据库设计 
**项目背景**：为实现高校校园消费与管理的数字化，需要设计核心数据库系统。
**主要管理对象**：

* 
**用户**：学生、教职工 


* 
**卡片**：校园一卡通（主卡、挂失补办） 


* 
**商户**：食堂、超市、书店等 


* 
**记录**：消费记录、充值记录 



**实验技术栈**：

* 数据库：openGauss 


* 开发语言：Java (JDBC连接) 


* 技能要求：掌握数据库设计全流程（需求分析、概念/逻辑/物理设计）、SQL DDL/DML/DQL 操作、视图与索引优化、用户权限管理 。



## 2. 系统功能与业务规则

* **一卡通规则**：
* 一用户一主卡，支持挂失/注销 。


* 余额不能为负数，需实时更新 。




* **交易规则**：
* 
**消费**：记录卡号、商户、金额、时间等 。


* 
**充值**：支持线下/线上，记录充值状态 。


* 
**商户**：记录营业状态（营业/停业） 。




* 
**查询功能**：用户信息、卡片状态、商户信息、消费/充值记录查询、余额查询 。



## 3. 作业任务流程

### 第一阶段：需求分析

* 
**产出**：0~1层数据流图、数据字典（包含数据项、数据结构、数据流、数据存储、处理过程） 。



### 第二阶段：概念与逻辑结构设计

* **产出**：
* 局部与全局 **E-R图** 。


* 
**关系模式设计**：满足第三范式 (3NF) 。


* 对象属性描述与关系描述 。





### 第三阶段：物理结构设计与实施

* 
**物理模型**：设计表名、字段、约束（主键、外键、非空、唯一等） 。


* **实施要求**：
* 创建 `campus_card` 数据库及同名 schema 。


* 
**数据填充**：用户表≥20条，卡片表≥20条，商户表≥10条，消费记录≥30条，充值记录≥20条 。


* 
**约束设置**：添加外键关联；设置金额大于0的约束；设置余额非负约束 。





### 第四阶段：SQL 运维实践

必须完成以下 SQL 操作并截图证明：

1. 
**基础查询**：单表查询、多表查询 。


2. **复杂查询**：
* 
**聚合查询**（如：总用户数、某商户平均消费） 。


* 
**连接查询**：半连接（有消费的用户）、反连接（无充值的用户）、多表连接 。


* 
**子查询**与排序（ORDER BY）、分组筛选（GROUP BY ... HAVING） 。




3. 
**视图与索引**：创建、修改、删除视图和索引 。


4. 
**数据变更**：修改和删除指定数据 。


5. 
**安全管理**：创建新用户 `card_user`，授予特定表的查询权限 。



### 第五阶段：应用开发

* 使用 JDBC 连接 openGauss。
* 创建测试表 `campus_sites` 并通过 Java 代码查询数据显示在控制台 。



---

# 文档二：在ECS上安装部署openGauss数据库指导手册

## 1. 实验环境准备

**实验目的**：在华为云 ECS（openEuler ARM架构）上单机部署 openGauss 。
**服务器配置建议**：

* 
**OS**：openEuler 20.03 64bit with ARM 。


* 
**CPU架构**：鲲鹏计算 (ARM) 。


* **规格**：2vCPUs | 4GiB 。


* 
**网络**：需配置弹性公网IP以便远程连接 。



## 2. 操作系统配置 (Root用户执行)

在安装数据库前，需对 OS 进行如下配置：

1. 
**设置字符集**：修改 `/etc/profile` 添加 `export LANG=en_US.UTF-8` 。


2. **切换 Python 版本**：
* openEuler 默认是 Python 2.7，openGauss 需要 Python 3.7.x 。


* 操作：备份旧版，建立软连接 `ln -s python3 /usr/bin/python` 。




3. 
**安装依赖**：安装 `libaio` 包 (`yum install libaio* -y`) 。



## 3. openGauss 安装步骤

### 3.1 下载与解压

* 创建目录 `/opt/software/openGauss` 并赋予 `755` 权限 。


* 使用 `wget` 下载 ARM 版本的安装包 。


* 解压安装包 (`.tar.gz`)，生成 `script` 目录 。



### 3.2 创建配置文件 (XML)

* 创建 `clusterconfig.xml` 文件，配置关键参数 ：


* `clusterName`: 数据库集群名称。
* `nodeNames`: 主机名（需与 ECS 名称一致）。
* `backIp1s`: ECS 私有 IP 地址。
* `dataNode1`: 数据存储目录 (如 `/gaussdb/data/db1`)。



### 3.3 初始化环境 (Pre-install)

* 
**修改系统脚本**：注释掉 `/etc/profile.d/performance.sh` 中关于 `vm.min_free_kbytes` 的设置 。


* **执行预安装**：
```bash
python gs_preinstall -U omm -G dbgrp -X /opt/software/openGauss/clusterconfig.xml

```


此步骤会创建 `omm` 用户并建立互信，需设置 omm 用户密码 。



### 3.4 执行安装 (Install)

* 切换到 `omm` 用户：`su - omm` 。


* **执行安装命令**（配置内存参数以适应 4G 内存机器）：
```bash
gs_install -X /opt/software/openGauss/clusterconfig.xml \
--gsinit-parameter="--encoding=UTF8" \
--dn-guc="max_process_memory=4GB" \
--dn-guc="shared_buffers=256MB"

```


需设置数据库管理员密码（需符合复杂度要求） 。



## 4. 数据库验证与使用

1. 
**检查状态**：`gs_om -t status` 。


2. 
**启动服务**：`gs_om -t start` 。


3. **连接数据库**：
```bash
gsql -d postgres -p 26000 -r

```


默认端口为 26000 。


4. **基础操作**：
* 创建用户：`CREATE USER joe WITH PASSWORD "Bigdata@123";` 。


* 创建数据库：`CREATE DATABASE db_tpcc OWNER joe;` 。


* 建表与插入数据测试 。





## 5. 常见问题 (FAQ)

* 
**Abnormal 状态 (THP 服务)**：需禁用透明大页 (Transparent HugePages)，修改 `/etc/rc.d/rc.local` 设置为 `never` 并重启 。


* 
**启动失败 (Shared Memory)**：若报 `could not create shared memory segment`，通常是内存不足。需使用 `gs_guc` 命令将 `shared_buffers` 调小（如 128MB）并重启 。
